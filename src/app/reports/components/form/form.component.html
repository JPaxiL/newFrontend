<!-- <p-confirmDialog header="Confirmation" icon="pi pi-exclamation-triangle"></p-confirmDialog> -->
<p-confirmDialog #cd [style]="{width: '50vw'}" key="newTabConfirmation">
    <ng-template pTemplate="header">
        <h3>Confirmación</h3>
    </ng-template>
    <ng-template pTemplate="footer">
        <button type="button" pButton icon="pi pi-times" label="No" (click)="cd.reject()"></button>
        <button type="button" pButton icon="pi pi-check" label="Si" (click)="cd.accept()"></button>
    </ng-template>
</p-confirmDialog>
<p-card>
    <ng-template pTemplate="header">
      <!-- <h2>Reportes GL Tracker</h2> -->
      <span class="d-block p-2 bg-primary text-white">REPORTES GL TRACKER</span>
    </ng-template>
      <div class="p-fluid y-form-container">
        <div class="row">
          <div class="p-field">
            <label>Tipo de reporte :</label>
            <p-dropdown [options]="reports" [(ngModel)]="selectedReport" optionLabel="value" optionValue="id" [showClear]="false" placeholder="Seleccione el reporte" (onChange)="changedReport(); validateForm();"></p-dropdown>
          </div>
        </div>
        <div class="row">
          <div class="col-6">
            <div class="p-field">
              <label>Vehículos:</label>
              <!-- <p-dropdown [options]="vehicles" [(ngModel)]="selectedVehicle" optionLabel="name" optionValue="id" [showClear]="false" placeholder="Seleccione vehiculos"></p-dropdown> -->
              <p-multiSelect [options]="vehicles" [(ngModel)]="selectedVehicles" optionLabel="name" (onChange)="onSelectedVehiclesChange(); validateForm();"></p-multiSelect>
            </div>
          </div>
          <div class="col-6" *ngIf="!checkboxGroup">
            <div class="p-field">
              <label>Convoy:</label>
              <p-dropdown [options]="convoys" [(ngModel)]="selectedConvoy" [showClear]="false" placeholder="Seleccione convoy/grupo" (onChange)="onSelectedConvoyChange(); validateForm();"></p-dropdown>
              <!-- <p-dropdown [options]="convoys" [(ngModel)]="selectedConvoy" optionLabel="value" optionValue="id" [showClear]="false" placeholder="Seleccione convoy/grupo"></p-dropdown> -->
            </div>
          </div>
          <div class="col-6" *ngIf="checkboxGroup">
            <div class="p-field">
              <label>Grupo:</label>
              <p-dropdown [options]="groups" [(ngModel)]="selectedGroup" [showClear]="false" placeholder="Seleccione grupo" (onChange)="onSelectedGroupChange(); validateForm();"></p-dropdown>
              <!-- <p-dropdown [options]="groups" [(ngModel)]="selectedGroup" optionLabel="value" optionValue="id" [showClear]="false" placeholder="Seleccione grupo"></p-dropdown> -->
            </div>
          </div>
        </div>
        
        <div class="row">
          <ng-container>
            <div class="row">
              <div class="col-6">
                <label>
                  <p-checkbox name="groupname" [binary]="true" [(ngModel)]="chkDateHour" (onChange)="onChkDateHourChange();">Fecha/Hora</p-checkbox>
                Fecha/Hora</label>
              </div>
              <div class="col-6">
                <div class="p-field">
                  <label>
                    <p-checkbox name="groupname" [(ngModel)]="checkboxGroup" [binary]="true" inputId="binary" ></p-checkbox>
                  Grupo</label>
                </div>
              </div>
            </div>
          </ng-container>
          <ng-container *ngIf="showMovStop">
            <div class="row">
              <div class="col-6">
                <div class="p-field">
                  <label>
                    <p-checkbox [(ngModel)]="chkStops" [binary]="true" inputId="binary" ></p-checkbox>
                  Paradas</label>
                </div>
              </div>
              <div class="col-6">
                <div class="p-field">
                  <label>
                    <p-checkbox [(ngModel)]="chkMovements" [binary]="true" inputId="binary" ></p-checkbox>
                  Movimientos</label>
                </div>
              </div>
            </div>
          </ng-container>
          
        </div>

        <ng-container *ngIf="showExcVelOpt">
          <div class="row">
            <div class="row">
              <div class="col-6">
                <div class="p-field">
                  <!-- <label>
                    <p-checkbox [(ngModel)]="chkSpeedLimit" [binary]="true" inputId="binary" ></p-checkbox>
                  Límite de Velocidad</label> -->
                  <p-radioButton name="exVe" value="limVel" label="Límite de Velocidad" [(ngModel)]="excesoVelocidad" (onClick)="showExcVel();"></p-radioButton>
                </div>
              </div>
              <div class="col-6">
                <div class="p-field">
                  <!-- <label>
                    <p-checkbox [(ngModel)]="chkDuracion" [binary]="true" inputId="binary" ></p-checkbox>
                  Duración</label> -->
                  <p-radioButton name="exVe" value="durExc" label="Duración" [(ngModel)]="excesoVelocidad" (onClick)="showExcVel();"></p-radioButton>
                </div>
              </div>
            </div>
          </div>    
        </ng-container>
        
        <div *ngIf="showExcVelOpt">
          <div class="row">
            <div class="col-6">
              <div class="p-field" *ngIf="excesoVelocidad == 'limVel'">
                <label>Límite de velocidad
                  <p-inputNumber [(ngModel)]="limitSpeed" [showButtons]="true" [min]="0" [max]="300" ></p-inputNumber>
                </label>
              </div>
            </div>
            <div class="col-6">
              <div class="p-field" *ngIf="excesoVelocidad == 'durExc'">
                <label>Duración
                  <p-inputNumber [(ngModel)]="minimDur" [showButtons]="true" [min]="0" suffix=" seg" ></p-inputNumber>
                </label>
              </div>
            </div>
          </div>
        </div>
        <div class="row" *ngIf="showLimitTime">
          <div class="col-12">
            <span>Límite de tiempo:</span>
            <!-- <span class="d-block p-2 bg-primary text-white">Limite de tiempo:</span> -->
          </div>
          <div class="col-6">
            <div class="row">
              <div class="p-field">
                <label>Fecha inicio:
                  <p-calendar [(ngModel)]="dateInit" dateFormat="dd/mm/yy" (onSelect)="validateForm(); onTimeChange();"></p-calendar>
                </label>
              </div>
            </div>
            <div class="row">
              <div class="p-field">
                <label>Hora inicio:
                  <p-calendar [(ngModel)]="timeInit" [timeOnly]="true" [readonlyInput]="true" (onSelect)="validateForm(); onTimeChange();"></p-calendar>
                </label>
              </div>
            </div>
          </div>
          <div class="col-6">
            <div class="row">
              <div class="p-field">
                <label>Fecha final:
                  <p-calendar [(ngModel)]="dateEnd" dateFormat="dd/mm/yy" (onSelect)="validateForm(); onTimeChange();"></p-calendar>
                </label>
              </div>
            </div>
            <div class="row">
              <div class="p-field">
                <label>Hora final:
                  <p-calendar [(ngModel)]="timeEnd" [timeOnly]="true" [readonlyInput]="true" (onSelect)="validateForm(); onTimeChange();"></p-calendar>
                </label>
              </div>
            </div>
          </div>
        </div>
        <div class="row" *ngIf="showZones">
          <div class="p-field">
            <label>Geocercas :</label>
            <p-multiSelect [options]="zones.data" [(ngModel)]="selectedZones" optionLabel="zone_name" optionValue="id" placeholder="Seleccione la(s) geocerca(s)" (onChange)=" validateForm();"></p-multiSelect>
          </div>
        </div>
      </div>
      
    <ng-template pTemplate="footer">
      <button [disabled]="!isFormFilled" (click)="confirm()" pButton type="button" label="Generar Reporte"></button>

    </ng-template>
</p-card>
