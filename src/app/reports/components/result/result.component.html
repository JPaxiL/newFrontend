<p-confirmDialog #cdExport [style]="{width: '400'}" key="showSelectExcelConfirmation">
  <ng-template pTemplate="header">
      <h4>Elija un formato para exportar</h4>
  </ng-template>
  <ng-template pTemplate="footer">
      <button type="button" pButton label="UNIDO" (click)="cdExport.reject()"></button>
      <button type="button" pButton label="SEPARADO" (click)="cdExport.accept()"></button>
  </ng-template>
</p-confirmDialog>

<div style="display: flex; flex-direction: column; padding: 0; height: 100%; max-height: 100%; margin: 0; font-size: 0.8rem;">
  <div [ngClass]="table_hide" class="container grand-container">
    <div *ngIf="num_rep == 0 || num_rep == 1 || num_rep == 2 || num_rep == 7 || num_rep == 14 || num_rep == 15 || num_rep == 16 || num_rep == 17 || num_rep == 18 " class="table-title" style="margin-bottom: 0.25rem;">{{rep_title}}</div>
    <div class="table-subtitle" style="margin-bottom: 0.25rem;">{{ rep_subtitle }}</div>
  </div>
  <ng-container>

    <!-- 0. REPORTE DE PARADAS Y MOVIMIENTOS -->

    <div class="container grand-container multitable-container" *ngIf="num_rep == 0">
      <div *ngFor="let v_table of data;  let i = index;" class="p-card" style="padding: 0.8rem;">

        <div class="subtable-title" style="margin-bottom: 0.25rem;">
          <div>VEHÍCULO: {{v_table[0][1]}}</div>
          <div>PERIODO: {{period}}</div>
        </div>

        <ng-container *ngIf="dtRendered">
          <table [ngClass]="table_hide" dt-instance="dtInstance" datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger" class="table table-striped table-border row-border hover">
            <thead>
              <tr>
                <th>Ítem</th>
                <th>Estado</th>
                <th *ngIf="!chkDateHour">Inicio</th>
                <th *ngIf="chkDateHour">Fecha de Inicio</th>
                <th *ngIf="chkDateHour">Hora de Inicio</th>
                <th *ngIf="!chkDateHour">Fin</th>
                <th *ngIf="chkDateHour">Fecha de Fin</th>
                <th *ngIf="chkDateHour">Hora de Fin</th>
                <th>Duración</th>
                <th *ngIf="v_table[2].Paradas">Posición detenida</th>
                <th *ngIf="v_table[2].Movimientos">Recorrido</th>
                <th *ngIf="v_table[2].Movimientos">Velocidad Máxima</th>
                <th *ngIf="v_table[2].Paradas">Punto cercano</th>
                <th *ngIf="v_table[2].Movimientos">Velocidad Promedio</th>
                <th *ngIf="v_table[2].Paradas">Referencia</th>
              </tr>
            </thead>

            <!-- PARADAS Y MOVIMIENTOS -->
            <tbody *ngIf="v_table[2].Paradas && v_table[2].Movimientos">
              <tr *ngFor="let row of v_table[1];  let i = index;">
                <td>{{i+1}}</td>
                <td>{{row.estado}}</td>
                <td *ngIf="!chkDateHour">{{row.fecha}}</td>
                <td *ngIf="chkDateHour">{{row.fecha.split(' ')[0]}}</td>
                <td *ngIf="chkDateHour">{{row.fecha.split(' ')[1]}}</td>
                <td *ngIf="!chkDateHour">{{row.fechasig}}</td>
                <td *ngIf="chkDateHour">{{row.fechasig.split(' ')[0]}}</td>
                <td *ngIf="chkDateHour">{{row.fechasig.split(' ')[1]}}</td>
                <td>{{row.duracion}}</td>
                <td *ngIf="row.esInt == 0">
                  <a href="http://maps.google.com/maps?q={{row.latitud.toFixed(6)}},{{row.longitud.toFixed(6)}}&amp;t=m" target="_blank">{{row.latitud.toFixed(6)}},{{row.longitud.toFixed(6)}}</a>
                </td><td *ngIf="row.esInt == 1">---</td>
                <td *ngIf="row.esInt == 0">---</td><td *ngIf="row.esInt == 1">{{row.recorrido}}</td>
                <td *ngIf="row.esInt == 0">---</td><td *ngIf="row.esInt == 1">{{row.maxima_velocidad}}</td>
                <td *ngIf="row.esInt == 0">{{row.pCercano}}</td><td *ngIf="row.esInt == 1">---</td>
                <td *ngIf="row.esInt == 0">---</td><td *ngIf="row.esInt == 1">{{row.vel_promedio}}</td>
                <td *ngIf="row.esInt == 0">{{row.referencia}}</td><td *ngIf="row.esInt == 1">---</td>
              </tr>
            </tbody>

            <!-- SOLO MOVIMIENTOS -->
            <tbody *ngIf="!v_table[2].Paradas && v_table[2].Movimientos">
              <tr *ngFor="let row of filterMovimientos(v_table[1]);  let i = index;">
                <td>{{i+1}}</td>
                <td>{{row.estado}}</td>
                <td *ngIf="!chkDateHour">{{row.fecha}}</td>
                <td *ngIf="chkDateHour">{{row.fecha.split(' ')[0]}}</td>
                <td *ngIf="chkDateHour">{{row.fecha.split(' ')[1]}}</td>
                <td *ngIf="!chkDateHour">{{row.fechasig}}</td>
                <td *ngIf="chkDateHour">{{row.fechasig.split(' ')[0]}}</td>
                <td *ngIf="chkDateHour">{{row.fechasig.split(' ')[1]}}</td>
                <td>{{row.duracion}}</td>
                <td>{{row.recorrido}}</td>
                <td>{{row.maxima_velocidad}}</td>
                <td>{{row.vel_promedio}}</td>
              </tr>
            </tbody>

            <!-- SOLO PARADAS -->
            <tbody *ngIf="v_table[2].Paradas && !v_table[2].Movimientos">
              <tr *ngFor="let row of filterParadas(v_table[1]);  let i = index;">
                <td>{{i+1}}</td>
                <td>{{row.estado}}</td>
                <td *ngIf="!chkDateHour">{{row.fecha}}</td>
                <td *ngIf="chkDateHour">{{row.fecha.split(' ')[0]}}</td>
                <td *ngIf="chkDateHour">{{row.fecha.split(' ')[1]}}</td>
                <td *ngIf="!chkDateHour">{{row.fechasig}}</td>
                <td *ngIf="chkDateHour">{{row.fechasig.split(' ')[0]}}</td>
                <td *ngIf="chkDateHour">{{row.fechasig.split(' ')[1]}}</td>
                <td>{{row.duracion}}</td>
                <td>
                  <a href="http://maps.google.com/maps?q={{row.latitud.toFixed(6)}},{{row.longitud.toFixed(6)}}&amp;t=m" target="_blank">{{row.latitud.toFixed(6)}},{{row.longitud.toFixed(6)}}</a>
                </td>
                <td>{{row.pCercano}}</td>
                <td>{{row.referencia}}</td>
              </tr>
            </tbody>

          </table>
        </ng-container>

        <div *ngIf="v_table[1].length == 0" class="p-card text-left" style="padding: 1rem;">
          <p>Ningún dato encontrado en su consulta.</p>
        </div>

        <div *ngIf="v_table[1].length != 0" class="p-card text-left" style="padding: 1rem;">
          <h6>RESUMEN DE TOTALES</h6>
          <p>Longitud de ruta       : <span>{{v_table[3][0]}}</span></p>
          <p>Duración de movimiento : <span>{{v_table[3][1]}}</span></p>
          <p>Duración de detenido   : <span>{{v_table[3][2]}}</span></p>
          <p>Velocidad más alta     : <span>{{v_table[3][3]}}</span></p>
          <p>Velocidad promedio     : <span>{{v_table[3][4]}}</span></p>
          <!-- <p ng-if="res.optionUser() == 445">Horas Trabajadas en el Periodo : <span>{{v_table[3][5]}}</span></p>
          <p ng-if="res.optionUser() == 445">Total de Horas Trabajadas : <span>{{v_table[3][6]}}</span></p>

          <p ng-if="res.optionUser() == 394">Total de combustible consumido: <span>{{v_table[3][7]}}</span></p>
          <p ng-if="res.optionUser() == 394">Total de distancia recorrida(CAN): <span>{{v_table[3][8]}}</span></p>
          <p ng-if="res.optionUser() == 394">Rendimiento por galón: <span>{{v_table[3][9]}}</span></p> -->

          </div>

      </div>
    </div>

    <!-- 1. REPORTE DE EXCESO DE VELOCIDAD -->

    <div class="container grand-container multitable-container" *ngIf="num_rep == 1">
      <div *ngFor="let v_table of data;  let i = index;" class="p-card" style="padding: 0.8rem;">

        <div class="subtable-title" style="margin-bottom: 0.25rem;">
          <div>VEHÍCULO: {{v_table[0][1]}}</div>
          <div>PERIODO: {{period}}</div>
        </div>

        <ng-container *ngIf="dtRendered && !chkDuracion">
          <table [ngClass]="table_hide" dt-instance="dtInstance" datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger" class="table table-striped table-border row-border hover">
            <thead>
              <tr>
                <th>Ítem</th>
                <th>Nombre</th>
                <th *ngIf="!chkDateHour">Fecha y Hora</th>
                <th *ngIf="chkDateHour">Fecha</th>
                <th *ngIf="chkDateHour">Hora</th>
                <th>Máxima Velocidad</th>
                <th>Ubicación</th>
                <th>Punto Cercano</th>
              </tr>
            </thead>

            <tbody>
              <tr *ngFor="let row of v_table[1];  let i = index;">
                <td>{{i+1}}</td>
                <td>{{row.nombre}}</td>
                <td *ngIf="!chkDateHour">{{row.fecha}}</td>
                <td *ngIf="chkDateHour">{{row.fecha.split(' ')[0]}}</td>
                <td *ngIf="chkDateHour">{{row.fecha.split(' ')[1]}}</td>
                <td>{{row.maxima_velocidad}}</td>
                <td>
                  <a href="http://maps.google.com/maps?q={{row.latitud.toFixed(6)}},{{row.longitud.toFixed(6)}}&amp;t=m" target="_blank">{{row.latitud.toFixed(6)}},{{row.longitud.toFixed(6)}}</a>
                </td>
                <td>{{row.PC}}</td>
              </tr>
            </tbody>

          </table>
        </ng-container>

        <ng-container *ngIf="dtRendered && chkDuracion">
          <table [ngClass]="table_hide" dt-instance="dtInstance" datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger" class="table table-striped table-border row-border hover">
            <thead>
              <tr>
                <th>Ítem</th>
                <th *ngIf="!chkDateHour">Inicio</th>
                <th *ngIf="chkDateHour">Fecha de Inicio</th>
                <th *ngIf="chkDateHour">Hora de Inicio</th>
                <th *ngIf="!chkDateHour">Fin</th>
                <th *ngIf="chkDateHour">Fecha de Fin</th>
                <th *ngIf="chkDateHour">Hora de Fin</th>
                <th>Duración</th>
                <th>Cant. de Tramas</th>
                <th>Tramas</th>
                <th>Vel. Min.</th>
                <th>Vel. Máx.</th>
                <th>Punto Cercano</th>
                <th>Zona Cercana</th>
                <th>Ubicación</th>
              </tr>
            </thead>

            <tbody>
              <tr *ngFor="let row of v_table[1];  let i = index;">
                <td>{{i+1}}</td>
                <td *ngIf="!chkDateHour">{{row.fecha_inicial}}</td>
                <td *ngIf="chkDateHour">{{row.fecha_inicial.split(' ')[0]}}</td>
                <td *ngIf="chkDateHour">{{row.fecha_inicial.split(' ')[1]}}</td>
                <td *ngIf="!chkDateHour">{{row.fecha_final}}</td>
                <td *ngIf="chkDateHour">{{row.fecha_final.split(' ')[0]}}</td>
                <td *ngIf="chkDateHour">{{row.fecha_final.split(' ')[1]}}</td>
                <td>{{row.duracion}}</td>
                <td>{{row.cant_tramas}}</td>
                <td>{{row.string_tramas}}</td>
                <td>{{row.vel_min}}</td>
                <td>{{row.vel_max}}</td>
                <td>{{row.PC}}</td>
                <td>{{row.ZC}}</td>
                <td>
                  <a href="http://maps.google.com/maps?q={{row.latitud.toFixed(6)}},{{row.longitud.toFixed(6)}}&amp;t=m" target="_blank">{{row.latitud.toFixed(6)}},{{row.longitud.toFixed(6)}}</a>
                </td>
              </tr>
            </tbody>

          </table>
        </ng-container>

      </div>
    </div>

    <!-- 2. REPORTE DE ENTRADA Y SALIDA -->

    <div class="container grand-container multitable-container" *ngIf="num_rep == 2">
      <div *ngFor="let v_table of data;  let i = index;" class="p-card" style="padding: 0.8rem;">

        <div class="subtable-title" style="margin-bottom: 0.25rem;">
          <div>VEHÍCULO: {{v_table[0][1]}}</div>
          <div>PERIODO: {{period}}</div>
        </div>

        <ng-container *ngIf="dtRendered">
          <table [ngClass]="table_hide" dt-instance="dtInstance" datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger" class="table table-striped table-border row-border hover">
            <thead>
              <tr>
                <th>Ítem</th>
                <th>Fecha de Entrada</th>
                <th *ngIf="chkDateHour">Hora de Entrada</th>
                <th>Fecha de Salida</th>
                <th *ngIf="chkDateHour">Hora de Salida</th>
                <th>Duración</th>
                <th>Nombre de Zona</th>
                <th>Posición de Zona</th>
                <th>Punto Cercano</th>
              </tr>
            </thead>

            <tbody>
              <tr *ngFor="let row of v_table[1];  let i = index;">
                <td>{{i+1}}</td>
                <td *ngIf="!chkDateHour">{{row.fecha}}</td>
                <td *ngIf="chkDateHour">{{row.fecha.split(' ')[0]}}</td>
                <td *ngIf="chkDateHour">{{row.fecha.split(' ')[1]}}</td>
                <td *ngIf="!chkDateHour">{{row.fecha_out}}</td>
                <td *ngIf="chkDateHour">{{row.fecha_out.split(' ')[0]}}</td>
                <td *ngIf="chkDateHour">{{row.fecha_out.split(' ')[1]}}</td>
                <td>{{row.duracion}}</td>
                <td>{{row.nombre_zona}}</td>
                <td>
                  <a href="http://maps.google.com/maps?q={{row.latitud.toFixed(6)}},{{row.longitud.toFixed(6)}}&amp;t=m" target="_blank">{{row.latitud.toFixed(6)}},{{row.longitud.toFixed(6)}}</a>
                </td>
                <td>{{row.PC}}</td>
              </tr>
            </tbody>
          </table>
        </ng-container>

      </div>
    </div>

    <!-- 7. REPORTE DE POSICIÓN -->

    <div class="container p-card singletable-container" *ngIf="num_rep == 7">
      <table *ngIf="dtRendered" [ngClass]="table_hide" dt-instance="dtInstance" datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger" class="table table-striped table-border row-border hover">
        <thead>
          <tr>
            <th>Index</th>
            <th>Código</th>
            <th>Placa</th>
            <th *ngIf="!chkDateHour">Fecha/Hora</th>
            <th *ngIf="chkDateHour">Fecha</th>
            <th *ngIf="chkDateHour">Hora</th>
            <th>Status</th>
            <th>Velocidad GPS</th>
            <th>Velocidad CAN</th>
            <th>Odómetro</th>
            <th>Ubicación</th>
            <th>Referencia</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let row of data;  let i = index;">
            <td>{{i+1}}</td>
            <td>{{row.codigo}}</td>
            <td>{{row.placa}}</td>
            <td *ngIf="!chkDateHour">{{row.fecha}}</td>
            <td *ngIf="chkDateHour">{{row.fecha.split(' ')[0]}}</td>
            <td *ngIf="chkDateHour">{{row.fecha.split(' ')[1]}}</td>
            <td>{{row['estado']}}</td>
            <td>{{(row.velocidad != '-')? row.velocidad + ' km/h': '-'}}</td>
            <td>{{(row.velocidad_can != '-')? row.velocidad_can + ' km/h': '-'}}</td>
            <td>{{row.odometro}}</td>
            <td>
              <a href="http://maps.google.com/maps?q={{row.latitud.toFixed(6)}},{{row.longitud.toFixed(6)}}&amp;t=m" target="_blank">{{row.latitud.toFixed(6)}}, {{row.longitud.toFixed(6)}}</a>
            </td>
            <td>{{row.zonaCercana}}</td>
          </tr>
        </tbody>
      </table>
    </div>




    <!-- 14. REPORTE DE ANTICOLISION FRONTAL-->
    <div class="container grand-container" *ngIf="num_rep == 14">
      <div *ngFor="let v_table of data;  let i = index;" class="p-card" style="padding: 1rem;">

        <div class="subtable-title" style="margin-bottom: 0.25rem;">
          <div>VEHÍCULO: {{v_table[0][1]}}</div>
          <div>PERIODO: {{period}}</div>
        </div>

        <ng-container *ngIf="dtRendered">
          <table [ngClass]="table_hide" dt-instance="dtInstance" datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger" class="table table-striped table-border row-border hover">
            <thead>
              <tr>
                  <th>Item</th>
                  <th *ngIf="!chkDateHour">Fecha/Hora</th>
                  <th *ngIf="chkDateHour">Fecha</th>
                  <th *ngIf="chkDateHour">Hora</th>
                  <th>Código</th>
                  <th>Placa</th>
                  <th>Tipo de Unidad</th>

                  <th>Id Conductor</th>
                  <th>Conductor</th>
                  <th>Vel.GPS</th>
                  <th>Vel.CAN</th>

                  <th>Tramo</th>
                  <th>Punto Cercano</th>
                  <th>Ubicación</th>

              </tr>
            </thead>

            <!-- PARADAS Y MOVIMIENTOS -->
            <tbody>
              <tr *ngFor="let row of v_table[1];  let i = index;">

                  <td>{{i + 1}}</td>
                  <td *ngIf="!chkDateHour">{{row.fecha}}</td>
                  <td *ngIf="chkDateHour">{{row.fecha.split(' ')[0]}}</td>
                  <td *ngIf="chkDateHour">{{row.fecha.split(' ')[1]}}</td>
                  <td>{{row.codigo}}</td>
                  <td>{{row.placa}}</td>
                  <td>{{row.tipo_unidad}}</td>

                  <td>{{row.idConductor}}</td>
                  <td>{{row.conductor}}</td>
                  <td>{{row.vel_gps_speed}} Km/h</td>
                  <td>{{row.vel_can}} Km/h</td>

                  <td>{{row.tramo}}</td>
                  <td>{{row.PC}}</td>
                  <td>
                    <a href="http://maps.google.com/maps?q={{row.latitud.toFixed(6)}},{{row.longitud.toFixed(6)}}&amp;t=m" target="_blank">{{row.latitud.toFixed(6)}},{{row.longitud.toFixed(6)}}</a>
                  </td>
              </tr>
            </tbody>

          </table>
        </ng-container>

        <div *ngIf="v_table[1].length == 0" class="p-card text-left" style="padding: 1rem;">
          <p>Ningún dato encontrado en su consulta.</p>
        </div>


      </div>
    </div>


    <!-- 15. REPORTE DE COLISIÓN CON PEATONES-->
    <div class="container grand-container" *ngIf="num_rep == 15">
      <div *ngFor="let v_table of data;  let i = index;" class="p-card" style="padding: 1rem;">

        <div class="subtable-title" style="margin-bottom: 0.25rem;">
          <div>VEHÍCULO: {{v_table[0][1]}}</div>
          <div>PERIODO: {{period}}</div>
        </div>

        <ng-container *ngIf="dtRendered">
          <table [ngClass]="table_hide" dt-instance="dtInstance" datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger" class="table table-striped table-border row-border hover">
            <thead>
              <tr>
                  <th>Item</th>
                  <th *ngIf="!chkDateHour">Fecha/Hora</th>
                  <th *ngIf="chkDateHour">Fecha</th>
                  <th *ngIf="chkDateHour">Hora</th>
                  <th>Código</th>
                  <th>Placa</th>
                  <th>Tipo de Unidad</th>

                  <th>Id Conductor</th>
                  <th>Conductor</th>
                  <th>Vel.GPS</th>
                  <th>Vel.CAN</th>

                  <th>Tramo</th>
                  <th>Punto Cercano</th>
                  <th>Ubicación</th>

              </tr>
            </thead>

            <!-- PARADAS Y MOVIMIENTOS -->
            <tbody>
              <tr *ngFor="let row of v_table[1];  let i = index;">

                  <td>{{i + 1}}</td>
                  <td *ngIf="!chkDateHour">{{row.fecha}}</td>
                  <td *ngIf="chkDateHour">{{row.fecha.split(' ')[0]}}</td>
                  <td *ngIf="chkDateHour">{{row.fecha.split(' ')[1]}}</td>
                  <td>{{row.codigo}}</td>
                  <td>{{row.placa}}</td>
                  <td>{{row.tipo_unidad}}</td>

                  <td>{{row.idConductor}}</td>
                  <td>{{row.conductor}}</td>
                  <td>{{row.vel_gps_speed}} Km/h</td>
                  <td>{{row.vel_can}} Km/h</td>

                  <td>{{row.tramo}}</td>
                  <td>{{row.PC}}</td>
                  <td>
                    <a href="http://maps.google.com/maps?q={{row.latitud.toFixed(6)}},{{row.longitud.toFixed(6)}}&amp;t=m" target="_blank">{{row.latitud.toFixed(6)}},{{row.longitud.toFixed(6)}}</a>
                  </td>
              </tr>
            </tbody>

          </table>
        </ng-container>

        <div *ngIf="v_table[1].length == 0" class="p-card text-left" style="padding: 1rem;">
          <p>Ningún dato encontrado en su consulta.</p>
        </div>


      </div>
    </div>

    <!-- 16. REPORTE DE DESVÍO DE CARRIL HACIA LA IZQUIERDA-->
    <div class="container grand-container" *ngIf="num_rep == 16">
      <div *ngFor="let v_table of data;  let i = index;" class="p-card" style="padding: 1rem;">

        <div class="subtable-title" style="margin-bottom: 0.25rem;">
          <div>VEHÍCULO: {{v_table[0][1]}}</div>
          <div>PERIODO: {{period}}</div>
        </div>

        <ng-container *ngIf="dtRendered">
          <table [ngClass]="table_hide" dt-instance="dtInstance" datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger" class="table table-striped table-border row-border hover">
            <thead>
              <tr>
                  <th>Item</th>
                  <th *ngIf="!chkDateHour">Fecha/Hora</th>
                  <th *ngIf="chkDateHour">Fecha</th>
                  <th *ngIf="chkDateHour">Hora</th>
                  <th>Código</th>
                  <th>Placa</th>
                  <th>Tipo de Unidad</th>

                  <th>Id Conductor</th>
                  <th>Conductor</th>
                  <th>Vel.GPS</th>
                  <th>Vel.CAN</th>

                  <th>Tramo</th>
                  <th>Punto Cercano</th>
                  <th>Ubicación</th>

              </tr>
            </thead>

            <!-- PARADAS Y MOVIMIENTOS -->
            <tbody>
              <tr *ngFor="let row of v_table[1];  let i = index;">

                  <td>{{i + 1}}</td>
                  <td *ngIf="!chkDateHour">{{row.fecha}}</td>
                  <td *ngIf="chkDateHour">{{row.fecha.split(' ')[0]}}</td>
                  <td *ngIf="chkDateHour">{{row.fecha.split(' ')[1]}}</td>
                  <td>{{row.codigo}}</td>
                  <td>{{row.placa}}</td>
                  <td>{{row.tipo_unidad}}</td>

                  <td>{{row.idConductor}}</td>
                  <td>{{row.conductor}}</td>
                  <td>{{row.vel_gps_speed}} Km/h</td>
                  <td>{{row.vel_can}} Km/h</td>

                  <td>{{row.tramo}}</td>
                  <td>{{row.PC}}</td>
                  <td>
                    <a href="http://maps.google.com/maps?q={{row.latitud.toFixed(6)}},{{row.longitud.toFixed(6)}}&amp;t=m" target="_blank">{{row.latitud.toFixed(6)}},{{row.longitud.toFixed(6)}}</a>
                  </td>
              </tr>
            </tbody>

          </table>
        </ng-container>

        <div *ngIf="v_table[1].length == 0" class="p-card text-left" style="padding: 1rem;">
          <p>Ningún dato encontrado en su consulta.</p>
        </div>


      </div>
    </div>


    <!-- 17.REPORTE DE DESVÍO DE CARRIL HACIA LA DERECHA-->
    <div class="container grand-container" *ngIf="num_rep == 17">
      <div *ngFor="let v_table of data;  let i = index;" class="p-card" style="padding: 1rem;">

        <div class="subtable-title" style="margin-bottom: 0.25rem;">
          <div>VEHÍCULO: {{v_table[0][1]}}</div>
          <div>PERIODO: {{period}}</div>
        </div>

        <ng-container *ngIf="dtRendered">
          <table [ngClass]="table_hide" dt-instance="dtInstance" datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger" class="table table-striped table-border row-border hover">
            <thead>
              <tr>
                  <th>Item</th>
                  <th *ngIf="!chkDateHour">Fecha/Hora</th>
                  <th *ngIf="chkDateHour">Fecha</th>
                  <th *ngIf="chkDateHour">Hora</th>
                  <th>Código</th>
                  <th>Placa</th>
                  <th>Tipo de Unidad</th>

                  <th>Id Conductor</th>
                  <th>Conductor</th>
                  <th>Vel.GPS</th>
                  <th>Vel.CAN</th>

                  <th>Tramo</th>
                  <th>Punto Cercano</th>
                  <th>Ubicación</th>

              </tr>
            </thead>

            <!-- PARADAS Y MOVIMIENTOS -->
            <tbody>
              <tr *ngFor="let row of v_table[1];  let i = index;">

                  <td>{{i + 1}}</td>
                  <td *ngIf="!chkDateHour">{{row.fecha}}</td>
                  <td *ngIf="chkDateHour">{{row.fecha.split(' ')[0]}}</td>
                  <td *ngIf="chkDateHour">{{row.fecha.split(' ')[1]}}</td>
                  <td>{{row.codigo}}</td>
                  <td>{{row.placa}}</td>
                  <td>{{row.tipo_unidad}}</td>

                  <td>{{row.idConductor}}</td>
                  <td>{{row.conductor}}</td>
                  <td>{{row.vel_gps_speed}} Km/h</td>
                  <td>{{row.vel_can}} Km/h</td>

                  <td>{{row.tramo}}</td>
                  <td>{{row.PC}}</td>
                  <td>
                    <a href="http://maps.google.com/maps?q={{row.latitud.toFixed(6)}},{{row.longitud.toFixed(6)}}&amp;t=m" target="_blank">{{row.latitud.toFixed(6)}},{{row.longitud.toFixed(6)}}</a>
                  </td>
              </tr>
            </tbody>

          </table>
        </ng-container>

        <div *ngIf="v_table[1].length == 0" class="p-card text-left" style="padding: 1rem;">
          <p>Ningún dato encontrado en su consulta.</p>
        </div>


      </div>
    </div>

    <!-- 18. REPORTE DE BLOQUEO DE VISIÓN DEL MOBILEYE-->
    <div class="container grand-container" *ngIf="num_rep == 18">
      <div *ngFor="let v_table of data;  let i = index;" class="p-card" style="padding: 1rem;">

        <div class="subtable-title" style="margin-bottom: 0.25rem;">
          <div>VEHÍCULO: {{v_table[0][1]}}</div>
          <div>PERIODO: {{period}}</div>
        </div>

        <ng-container *ngIf="dtRendered">
          <table [ngClass]="table_hide" dt-instance="dtInstance" datatable [dtOptions]="dtOptions" [dtTrigger]="dtTrigger" class="table table-striped table-border row-border hover">
            <thead>
              <tr>
                  <th>Item</th>
                  <th *ngIf="!chkDateHour">Fecha/Hora</th>
                  <th *ngIf="chkDateHour">Fecha</th>
                  <th *ngIf="chkDateHour">Hora</th>
                  <th>Código</th>
                  <th>Placa</th>
                  <th>Tipo de Unidad</th>

                  <th>Id Conductor</th>
                  <th>Conductor</th>
                  <th>Vel.GPS</th>
                  <th>Vel.CAN</th>

                  <th>Tramo</th>
                  <th>Punto Cercano</th>
                  <th>Ubicación</th>

              </tr>
            </thead>

            <!-- PARADAS Y MOVIMIENTOS -->
            <tbody>
              <tr *ngFor="let row of v_table[1];  let i = index;">

                  <td>{{i + 1}}</td>
                  <td *ngIf="!chkDateHour">{{row.fecha}}</td>
                  <td *ngIf="chkDateHour">{{row.fecha.split(' ')[0]}}</td>
                  <td *ngIf="chkDateHour">{{row.fecha.split(' ')[1]}}</td>
                  <td>{{row.codigo}}</td>
                  <td>{{row.placa}}</td>
                  <td>{{row.tipo_unidad}}</td>

                  <td>{{row.idConductor}}</td>
                  <td>{{row.conductor}}</td>
                  <td>{{row.vel_gps_speed}} Km/h</td>
                  <td>{{row.vel_can}} Km/h</td>

                  <td>{{row.tramo}}</td>
                  <td>{{row.PC}}</td>
                  <td>
                    <a href="http://maps.google.com/maps?q={{row.latitud.toFixed(6)}},{{row.longitud.toFixed(6)}}&amp;t=m" target="_blank">{{row.latitud.toFixed(6)}},{{row.longitud.toFixed(6)}}</a>
                  </td>
              </tr>
            </tbody>

          </table>
        </ng-container>

        <div *ngIf="v_table[1].length == 0" class="p-card text-left" style="padding: 1rem;">
          <p>Ningún dato encontrado en su consulta.</p>
        </div>


      </div>
    </div>


    <div *ngIf="dtRendered" class="export-container">
      <button *ngIf="num_rep == 0" class="btn btn-success" (click)="showSelectExcel('exportExcelParadasMovimientos');">EXPORTAR EXCEL</button>
      <button *ngIf="num_rep == 1" class="btn btn-success" (click)="showSelectExcel('exportExcelExcesosVelocidad');">EXPORTAR EXCEL</button>
      <button *ngIf="num_rep == 2" class="btn btn-success" (click)="showSelectExcel('exportExcelEntradaSalida');">EXPORTAR EXCEL</button>
      <button *ngIf="num_rep == 7" class="btn btn-success" (click)="exportExcelPosicion(1);">EXPORTAR EXCEL</button>
      <!-- <div style="display: flex; flex-direction: row; justify-content: center; gap: 4rem; margin: 0; padding: 0;">
        <button class="btn btn-success" (click)="exportExcelParadasMovimientos(1)">EXPORTAR EXCEL SEPARADO</button>
        <button class="btn btn-success" (click)="exportExcelParadasMovimientos(2)">EXPORTAR EXCEL JUNTO</button>
      </div> -->

        <!-- <md-button class="md-raised md-primary" ng-click="res.exportPdfParadasMovimientos()">EXPORTAR PDF</md-button>  -->
    </div>

  </ng-container>
</div>
