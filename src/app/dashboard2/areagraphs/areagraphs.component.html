<div
        class="d-flex flex-column justify-content-center align-items-center"
        style="position: absolute;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.8);
        z-index: 999999;" *ngIf="isUnderConstruction">
        <img
            src="./assets/images/en_construccion.png"
            alt="under_construction"
            style="display: flex; max-width: 50%; max-height: 20rem; margin-bottom: 1rem;">
        <span style="color: #fff;">Panel en construcción</span>
    </div>

<div class="container-fluid dashboard-wrapper" style="position: relative;" *ngIf="!isUnderConstruction">

    <ngx-spinner bdColor = "rgba(0, 0, 0, 0.8)" name="loadingDashboardSpinner" size = "medium" color = "#fff" type = "ball-pulse" [fullScreen] = "true"><p style="color: white" class="text-center"> Cargando Dashboard... </p></ngx-spinner>

    <div class="row header-padding"></div>
    <div class="row dashboard-content p-3 overflow-auto justify-content-center">
        
        <div class="row p-card p-2 mb-3">
            <div class="col-12">
                <h3>Dash Board</h3>
                <hr>
            </div>
        </div>

        <br>
        <div class="row p-card p-2 mb-3 rounded">
            <div class="col-12 mb-3">
                <h4>Estatus general de la Flota Vehicular</h4>
                <hr>
            </div>
            <div class="col-12">
                <div class="row">
                    <div class="col-6">
                        <ngx-charts-pie-chart
                        [scheme]="colorScheme"
                        [results]="data"
                        [legend]="showLegend"
                        [legendPosition]="'left'"
                        [legendTitle]="''"
                        >
                        </ngx-charts-pie-chart>
                    </div>
                    <div class="col-6">
                        <div class="col-sm table-responsive">
                            <div class="d-flex gap-2 mb-3">
                                <div class="flex-grow-1 general-status-header">Relación de Vehículos</div>
                                <button type="button" class="btn btn-success">cc</button>
                            </div>

                            <table>
                                <thead>
                                    <tr>
                                        <th>En movimiento</th>
                                        <th>Detenidos</th>
                                        <th>Sin cobertura</th>
                                        <th>Sin transmision</th>
                                        <th>Corte de transmision</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>
                                            <ul class="list-unstyled">
                                                <li *ngFor="let imei of imeiGreen">{{ imei }}</li>
                                            </ul>
                                        </td>
                                        <td>
                                            <ul class="list-unstyled">
                                                <li *ngFor="let imei of imeiBlue">{{ imei }}</li>
                                            </ul>
                                        </td>
                                        <td>
                                            <ul class="list-unstyled">
                                                <li *ngFor="let imei of imeiOrange">{{ imei }}</li>
                                            </ul>
                                        </td>
                                        <td>
                                            <ul class="list-unstyled">
                                                <li *ngFor="let imei of imeiBlack">{{ imei }}</li>
                                            </ul>
                                        </td>
                                        <td>
                                            <ul class="list-unstyled">
                                                <li *ngFor="let imei of imeiRed">{{ imei }}</li>
                                            </ul>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

            </div>

        </div>

        <div class="row p-0 gap-3 mb-3">
            <div class="col-md-7">
                <div class="row p-card p-2 mb-3 rounded">
                    <div class="col-12 mb-3">
                        <h4>Unidades en servicio y sin programación</h4>
                        <hr>
                    </div>
                    <div class="col-12">
                        <div class="row">
                            <div class="col d-flex justify-content-center align-items-center text-center">
                                <span>
                                    En servicio
                                    <br>{{in_service}}/{{in_service_percentage}}%
                                </span>
                            </div>
                            <div class="col-7">
                                <ngx-charts-bar-horizontal-stacked
                                    *ngIf="'bar-horizontal-stacked' === 'bar-horizontal-stacked'"
                                    class="chart-container"
                                    [gradient]="true"
                                    [scheme]="colorSchemeHorizontalChart"
                                    [results]="horizontalChart"
                                ></ngx-charts-bar-horizontal-stacked>
                                <!-- <ngx-charts-bar-horizontal-stacked
                                    *ngIf="'bar-horizontal-stacked' === 'bar-horizontal-stacked'"
                                    class="chart-container"
                                    [view]="[700,100]"
                                    [gradient]="true"
                                    [scheme]="colorSchemeHorizontalChart"
                                    [results]="horizontalChart"
                                ></ngx-charts-bar-horizontal-stacked> -->
                            </div>
                            <div class="col d-flex justify-content-center align-items-center text-center">
                                <span>
                                    Sin programación
                                    <br>{{without_programming}}/{{without_programming_percentage}}%
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row p-card p-2 rounded">
                    <div class="col-12 mb-3">
                        <h4>Consumo de combustible de la flota vehicular</h4>
                        <hr>
                    </div>
                    <div class="col-12">
                    </div>
                </div>
            </div>
            <div class="col">
                <div class="row p-card p-2 rounded h-100">
                    <div class="col-12 mb-3">
                        <h4>Lugar donde se ubican las unidades</h4>
                        <hr>
                    </div>
                    <div class="col-12">
                    </div>
                </div>
            </div>
        </div>

        <div class="row p-0 gap-3">
            <div class="col-md col-12">
                <div class="row p-card p-2 rounded h-100 align-content-start" style="position: relative;">

                    <ngx-spinner bdColor = "rgba(0, 0, 0, 0.8)" name="loadingInfractionSpinner" size = "small" color = "#fff" type = "ball-pulse" ><p style="color: white" class="text-center"> Cargando Infracciones... </p></ngx-spinner>
                    <h4>Vehículos que cometieron infracción</h4>
                    <hr>
                    <br>
                    <p-calendar
                        [(ngModel)]="date_infraction"
                        [dateFormat] = "'dd/mm/yy'"
                        [readonlyInput]="true"
                        inputId="range"
                        selectionMode="range"
                    >
                    </p-calendar>
                    <button btn btn-secondary (click)="getInfraction()">Ir</button>
                    <br>
                    <table class="table">
                        <thead>
                            <tr class="table-active">
                                <th scope="col">Vehículo</th>
                                <th scope="col">No de Infracciones</th>
                                <th scope="col">Infracción mas Grave</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let vehicle of infraction">
                                <td>{{vehicle.name}}</td>
                                <td>{{vehicle.amount}}</td>
                                <td>{{vehicle.higher_speed}}</td>
                            </tr>
                        </tbody>
                    </table>

                </div>
            </div>

            <div class="col-md col-12">
                <div class="row p-card p-2 rounded h-100 align-content-start" style="position: relative;">
                
                    <ngx-spinner bdColor = "rgba(0, 0, 0, 0.8)" name="loadingGpsSpinner" size = "small" color = "#fff" type = "ball-pulse" ><p style="color: white" class="text-center"> Cargando Alertas Gps... </p></ngx-spinner>
                    <h4>Vehículos que generaron alertas GPS</h4>
                    <hr>
                    <br>
                    <p-calendar
                        [(ngModel)]="date_gps"
                        [dateFormat] = "'dd/mm/yy'"
                        [readonlyInput]="true"
                        inputId="range"
                        selectionMode="range"
                    >
                    </p-calendar>
                    <button btn btn-secondary (click)="getEventGps()">Ir</button>
                    <br>
                    <table  style="width:80%;">
                        <tr>
                            <td>Batería desconectada</td>
                            <td style="width: 50%;">
                                <ngb-progressbar
                                    type="primary"
                                    [value]="countgpsEvents.bateria_desconectada"
                                    [max]="gpsEventsTotal"
                                    [height]="'20px'"
                                ></ngb-progressbar>
    
                            </td>
                            <td>{{countgpsEvents.bateria_desconectada}}</td>
                        </tr>
                        <tr>
                            <td>Aceleración brusca</td>
                            <td style="width: 50%;">
                                <ngb-progressbar
                                    type="primary"
                                    [value]="countgpsEvents.aceleracion_brusca"
                                    [max]="gpsEventsTotal"
                                    [height]="'20px'"
                                ></ngb-progressbar>
    
                            </td>
                            <td style="text-align: center;">{{countgpsEvents.aceleracion_brusca}}</td>
                        </tr>
                        <tr>
                            <td>Frenada Brusca</td>
                            <td style="width: 50%;">
                                <ngb-progressbar
                                    type="primary"
                                    [value]="countgpsEvents.frenada_brusca"
                                    [max]="gpsEventsTotal"
                                    [height]="'20px'"
                                ></ngb-progressbar>
    
                            </td>
                            <td style="text-align: center;">{{countgpsEvents.frenada_brusca }}</td>
                        </tr>
                        <tr>
                            <td>SOS</td>
                            <td style="width: 50%;">
                                <ngb-progressbar
                                    type="primary"
                                    [value]="countgpsEvents.sos"
                                    [max]="gpsEventsTotal"
                                    [height]="'20px'"
                                ></ngb-progressbar>
    
                            </td>
                            <td style="text-align: center;">{{countgpsEvents.sos}}</td>
                        </tr>
                        <tr>
                            <td>Motor apagado</td>
                            <td style="width: 50%;">
                                <ngb-progressbar
                                    type="primary"
                                    [value]="countgpsEvents.motor_apagado"
                                    [max]="gpsEventsTotal"
                                    [height]="'20px'"
                                ></ngb-progressbar>
    
                            </td>
                            <td style="text-align: center;">{{countgpsEvents.motor_apagado}}</td>
                        </tr>
                        <tr>
                            <td>Motor encendido</td>
                            <td style="width: 50%;">
                                <ngb-progressbar
                                    type="primary"
                                    [value]="countgpsEvents.motor_encendido"
                                    [max]="gpsEventsTotal"
                                    [height]="'20px'"
                                ></ngb-progressbar>
    
                            </td>
                            <td style="text-align: center;">{{countgpsEvents.motor_encendido}}</td>
                        </tr>
                    </table><br> <br> <br>
    
                    <table class="table">
                        <thead>
                            <tr class="table-active">
                                <th scope="col">Vehículo</th>
                                <th scope="col">Alerta</th>
                                <th scope="col">Incidencias</th>
                            </tr>
                        </thead>
                        <tbody>
    
                                <tr *ngFor="let event of gpsEvents">
                                    <td>{{event.vehicle}}</td>
                                    <td>{{event.event}}</td>
                                    <td>{{event.amount}}</td>
                                </tr>
    
    
                        </tbody>
                    </table>

                </div>
            </div>

            <div class="col-md col-12">
                <div class="row p-card p-2 rounded h-100 align-content-start" style="position: relative;">
                
                    <ngx-spinner bdColor = "rgba(0, 0, 0, 0.8)" name="loadingSegSpinner" size = "small" color = "#fff" type = "ball-pulse" ><p style="color: white" class="text-center"> Cargando Alertas Seg. vehicular... </p></ngx-spinner>
                    <h4>Vehículos que generaron alertas Seg. vehicular</h4>
                    <hr>
                    <br>
                    <p-calendar
                        [(ngModel)]="date_safety"
                        [dateFormat] = "'dd/mm/yy'"
                        [readonlyInput]="true"
                        inputId="range"
                        selectionMode="range"
                    >
                    </p-calendar>
                    <button btn btn-secondary (click)="getVehicleSafety()">Ir</button>
                    <br>
                    <br><br>
                    <table  style="width:80%;">
                        <tr>
                            <td>Ausencia de rostro</td>
                            <td style="width: 50%;">
                                <ngb-progressbar
                                    type="primary"
                                    [value]="countVehicleSafetyEvents.no_rostro"
                                    [max]="safetyEventsTotal"
                                    [height]="'20px'"
                                ></ngb-progressbar>
    
                            </td>
                            <td style="text-align: center;">{{countVehicleSafetyEvents.no_rostro}}</td>
                        </tr>
                        <tr>
                            <td>Fatiga extrema</td>
                            <td style="width: 50%;">
                                <ngb-progressbar
                                    type="primary"
                                    [value]="countVehicleSafetyEvents.fatiga_extrema"
                                    [max]="safetyEventsTotal"
                                    [height]="'20px'"
                                ></ngb-progressbar>
    
                            </td>
                            <td style="text-align: center;">{{countVehicleSafetyEvents.fatiga_extrema}}</td>
                        </tr>
                        <tr>
                            <td>Posible fatiga</td>
                            <td style="width: 50%;">
                                <ngb-progressbar
                                    type="primary"
                                    [value]="countVehicleSafetyEvents.posible_fatiga"
                                    [max]="safetyEventsTotal"
                                    [height]="'20px'"
                                ></ngb-progressbar>
    
                            </td>
                            <td style="text-align: center;">{{countVehicleSafetyEvents.posible_fatiga}}</td>
                        </tr>
                        <tr>
                            <td>Distracción</td>
                            <td style="width: 50%;">
                                <ngb-progressbar
                                    type="primary"
                                    [value]="countVehicleSafetyEvents.distraccion"
                                    [max]="safetyEventsTotal"
                                    [height]="'20px'"
                                ></ngb-progressbar>
    
                            </td>
                            <td style="text-align: center;">{{countVehicleSafetyEvents.distraccion}}</td>
                        </tr>
                        <tr>
                            <td>Anticolisión frontal</td>
                            <td style="width: 50%;">
                                <ngb-progressbar
                                    type="primary"
                                    [value]="countVehicleSafetyEvents.colision_delantera"
                                    [max]="safetyEventsTotal"
                                    [height]="'20px'"
                                ></ngb-progressbar>
    
                            </td>
                            <td style="text-align: center;">{{countVehicleSafetyEvents.colision_delantera}}</td>
                        </tr>
                        <tr>
                            <td>Colisión con peatones</td>
                            <td style="width: 50%;">
                                <ngb-progressbar
                                    type="primary"
                                    [value]="countVehicleSafetyEvents.colision_con_peatones"
                                    [max]="safetyEventsTotal"
                                    [height]="'20px'"
                                ></ngb-progressbar>
    
                            </td>
                            <td style="text-align: center;">{{countVehicleSafetyEvents.colision_con_peatones}}</td>
                        </tr>
                        <tr>
                            <td>Desvío de carril izquierda</td>
                            <td style="width: 50%;">
                                <ngb-progressbar
                                    type="primary"
                                    [value]="countVehicleSafetyEvents.desvio_de_carril_hacia_la_izquierda"
                                    [max]="safetyEventsTotal"
                                    [height]="'20px'"
                                ></ngb-progressbar>
    
                            </td>
                            <td style="text-align: center;">{{countVehicleSafetyEvents.desvio_de_carril_hacia_la_izquierda}}</td>
                        </tr>
                        <tr>
                            <td>Desvío de carril derecha</td>
                            <td style="width: 50%;">
                                <ngb-progressbar
                                    type="primary"
                                    [value]="countVehicleSafetyEvents.desvio_de_carril_hacia_la_derecha"
                                    [max]="safetyEventsTotal"
                                    [height]="'20px'"
                                ></ngb-progressbar>
    
                            </td>
                            <td style="text-align: center;">{{countVehicleSafetyEvents.desvio_de_carril_hacia_la_derecha}}</td>
                        </tr>
                        <tr>
                            <td>Bloq. de visión de Mobileye</td>
                            <td style="width: 50%;">
                                <ngb-progressbar
                                    type="primary"
                                    [value]="countVehicleSafetyEvents.bloqueo_de_vision_del_mobileye"
                                    [max]="safetyEventsTotal"
                                    [height]="'20px'"
                                ></ngb-progressbar>
    
                            </td>
                            <td style="text-align: center;">{{countVehicleSafetyEvents.bloqueo_de_vision_del_mobileye}}</td>
                        </tr>
                    </table>
    
                    <br> <br> <br>
    
                    <table class="table">
                        <thead>
                            <tr class="table-active">
                                <th scope="col">Vehículo</th>
                                <th scope="col">Alerta</th>
                                <th scope="col">Incidencias</th>
                            </tr>
                        </thead>
                        <tbody>
    
                                <tr *ngFor="let event of vehicleSafetyEvents">
                                    <td>{{event.vehicle}}</td>
                                    <td>{{event.event}}</td>
                                    <td>{{event.amount}}</td>
                                </tr>
    
    
                        </tbody>
                    </table>

                </div>
            </div>
        </div>
</div>
